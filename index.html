<html>
<head>
  <title>Conway&#39s Life</title>
  <script src='jquery.min.js'></script>
  <script src='life.js'></script>

  <script>

var count = 0;
var counterRunning = false;

var last = null;
var lastlast = null;

function start() {
  var board = $('#board')[0];
  life.init(board);
  life.eventCallback(boardChanged);
  glider();
}

function update() {
  lastlast = last;
  last = life.copyBoard();
  life.generation();
  life.draw();
  if (counterRunning) {
    if (life.areBoardsEqual(last) ||
        life.areBoardsEqual(lastlast)) {
      counterRunning = false;
    } else {
      counter++;
      $('#counter').text(counter);
    }
  }
}

var intervalID = null;

function run() {
  var btn = $('#run')[0];
  if (intervalID) {
    window.clearInterval(intervalID);
    intervalID = null;
    btn.value = "Run";
  } else {
    intervalID = window.setInterval(update, 100);
    btn.value = "Stop";
  }
}

var startBoard = null;

function startCounter() {
  counter = 0;
  counterRunning = true;
  startBoard = life.copyBoard();
  $('#counter').text(counter);
}

function boardChanged() {
  startCounter();
}

function glider() {
  life.addGlider();
  life.draw();
  startCounter();
}
  </script>
</head>

<body onload='start();'>
<canvas id='board' width='600' height='600' tabindex='1'></canvas>
<br/>
<input type='submit' onClick='update()' value='Update'/>
<input type='submit' onClick='life.clear()' value='Clear'/>
<input type='submit' onClick='glider()' value='Glider'/>
<input type='submit' id='run' onClick='run()' value='Run'/>
<span id='counter'></span>
<br/>
<br/>
<a href='https://github.com/billstclair/life.js'>Source on GitHub</a>
</body>
</html>
